"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[197],{197:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var l=a(43),s=a(216),r=a(625),i=a(526),n=a(291),o=a(579);const d=e=>{let{isOpen:t,onClose:a}=e;const{user:s,updateUser:i}=(0,r.A)(),[d,c]=(0,l.useState)((null===s||void 0===s?void 0:s.firstName)||""),[m,u]=(0,l.useState)((null===s||void 0===s?void 0:s.lastName)||""),[x,h]=(0,l.useState)((null===s||void 0===s?void 0:s.username)||""),[f,p]=(0,l.useState)((null===s||void 0===s?void 0:s.email)||""),[b,g]=(0,l.useState)(!1),[v,N]=(0,l.useState)(""),j=(0,l.useRef)(null),[y,w]=(0,l.useState)(null),[k,C]=(0,l.useState)((null===s||void 0===s?void 0:s.profileImage)||null),[E,P]=(0,l.useState)(!1);if((0,l.useEffect)((()=>{t&&s&&(c(s.firstName||""),u(s.lastName||""),h(s.username||""),p(s.email||""),C(s.profileImage||null),w(null),N(""))}),[t,s]),!t)return null;const S=()=>{j.current&&j.current.click()};return(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:a,children:(0,o.jsxs)("div",{className:"rounded-lg p-6 w-full max-w-md",style:{backgroundColor:"#ff7b7b"},onClick:e=>e.stopPropagation(),children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Edit Profile"}),v&&(0,o.jsx)("div",{className:"bg-red-100 text-red-700 p-2 rounded mb-4",children:v}),(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),g(!0),N("");try{const e=new FormData;e.append("username",x),e.append("email",f),e.append("firstName",d),e.append("lastName",m),y&&e.append("profileImage",y);const t=await n.j2.updateProfile(e);if(console.log("Profile update response:",t),s){const e=await n.j2.getProfile();i({id:e.data.id,username:e.data.username,firstName:e.data.firstName,lastName:e.data.lastName,email:e.data.email,dateOfBirth:e.data.dateOfBirth,profileImage:e.data.profileImage}),a()}}catch(r){var t,l;if(console.error("Profile update error:",r),r.response)N(`Error ${r.response.status}: ${(null===(t=r.response.data)||void 0===t?void 0:t.message)||(null===(l=r.response.data)||void 0===l?void 0:l.detail)||"Failed to update profile"}`);else r.request?N("No response received from server. Check your connection."):N(`Error: ${r.message}`)}finally{g(!1)}},children:[(0,o.jsx)("input",{id:"profilePicture",type:"file",className:"hidden",onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];w(t);const a=new FileReader;a.onload=()=>{C(a.result)},a.readAsDataURL(t)}},ref:j,"aria-label":"Profile Picture",accept:"image/*"}),(0,o.jsxs)("div",{className:"mb-6 flex flex-col items-center",children:[(0,o.jsxs)("div",{className:"relative w-32 h-32 rounded-full mb-3 overflow-hidden border-4 border-white group cursor-pointer",onClick:S,onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1),role:"button","aria-label":"Change profile picture",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||S()},children:[k?(0,o.jsx)("img",{src:k,alt:"Profile Preview",className:"w-full h-full object-cover"}):(0,o.jsx)("div",{className:"w-full h-full bg-white bg-opacity-90 flex items-center justify-center text-gray-500",children:"No Image"}),(0,o.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex flex-col items-center justify-center text-white transition-opacity "+(E?"opacity-100":"opacity-0"),children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,o.jsx)("span",{className:"text-xs font-semibold",children:"Change Photo"})]})]}),(0,o.jsx)("p",{className:"text-white text-sm text-center mb-2",children:"Click on the image to change your profile picture"})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"firstName",className:"block text-white mb-1",children:"First Name"}),(0,o.jsx)("input",{id:"firstName",type:"text",className:"w-full py-3 px-4 rounded-3xl bg-white bg-opacity-90 border-none text-gray-800",value:d,onChange:e=>c(e.target.value),"aria-label":"First Name",placeholder:"Enter your first name",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"lastName",className:"block text-white mb-1",children:"Last Name"}),(0,o.jsx)("input",{id:"lastName",type:"text",className:"w-full py-3 px-4 rounded-3xl bg-white bg-opacity-90 border-none text-gray-800",value:m,onChange:e=>u(e.target.value),"aria-label":"Last Name",placeholder:"Enter your last name",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"username",className:"block text-white mb-1",children:"Username"}),(0,o.jsx)("input",{id:"username",type:"text",className:"w-full py-3 px-4 rounded-3xl bg-white bg-opacity-90 border-none text-gray-800",value:x,onChange:e=>h(e.target.value),"aria-label":"Username",placeholder:"Enter your username",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"email",className:"block text-white mb-1",children:"Email"}),(0,o.jsx)("input",{id:"email",type:"email",className:"w-full py-3 px-4 rounded-3xl bg-white bg-opacity-90 border-none text-gray-800",value:f,onChange:e=>p(e.target.value),"aria-label":"Email",placeholder:"Enter your email",required:!0})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,o.jsx)("button",{type:"button",className:"px-4 py-3 bg-white bg-opacity-25 rounded-3xl hover:bg-opacity-40 text-white font-bold",onClick:a,disabled:b,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:"px-4 py-3 bg-red-500 rounded-3xl hover:bg-red-600 text-white font-bold",disabled:b,children:b?"Saving...":"Save Changes"})]})]})]})})},c=()=>{const e=(0,s.Zp)(),{user:t,logout:a}=(0,r.A)(),[n,c]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!1),x=`https://ui-avatars.com/api/?name=${(()=>{if(!t)return"U";return(t.firstName?t.firstName.charAt(0).toUpperCase():"")+(t.lastName?t.lastName.charAt(0).toUpperCase():"")||"U"})()}&background=FF7070&color=fff&size=256`,h=!m&&null!==t&&void 0!==t&&t.profileImage?t.profileImage:x;(0,l.useEffect)((()=>{console.log("User profile data:",t),console.log("Profile picture URL:",h)}),[t,h]);return(0,o.jsxs)("div",{className:"min-h-screen bg-red-400 p-4",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-8 px-1",children:[(0,o.jsx)("div",{className:"flex-1"}),(0,o.jsx)("div",{className:"text-center flex-1",children:(0,o.jsx)("h1",{className:"text-white text-2xl font-bold",children:"Profile"})}),(0,o.jsx)("div",{className:"flex-1 flex justify-end pt-1",children:(0,o.jsx)(i.A,{})})]}),(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center mt-8",children:[(0,o.jsx)("div",{className:"avatar mb-4",children:(0,o.jsx)("div",{className:"w-24 rounded-full ring ring-white",children:(0,o.jsx)("img",{src:h,alt:"Profile",onError:()=>{console.error("Error loading profile image:",null===t||void 0===t?void 0:t.profileImage),u(!0)}})})}),(0,o.jsx)("h1",{className:"text-white text-xl font-bold mb-8",children:t?`${t.firstName} ${t.lastName}`:"Guest User"}),(0,o.jsxs)("div",{className:"w-full max-w-xs space-y-4",children:[(0,o.jsx)("button",{className:"btn w-full bg-red-300 hover:bg-red-500 text-white border-none",onClick:()=>{c(!0)},children:"Edit Profile"}),(0,o.jsx)("button",{className:"btn w-full bg-red-300 hover:bg-red-500 text-white border-none",onClick:()=>e("/dietary-preferences"),children:"Edit Dietary Preferences"}),(0,o.jsx)("button",{className:"btn w-full bg-red-500 hover:bg-red-600 text-white border-none mt-8",onClick:()=>{a(),e("/")},children:"Logout"})]})]}),(0,o.jsx)(d,{isOpen:n,onClose:()=>{c(!1),u(!1)}})]})}},526:(e,t,a)=>{a.d(t,{A:()=>n});var l=a(43),s=a(216),r=a(625),i=a(579);const n=e=>{let{showMenu:t=!0}=e;const{user:a,logout:n}=(0,r.A)(),o=(0,s.Zp)(),d=(0,s.zy)(),[c,m]=(0,l.useState)(!1),u=(0,l.useRef)(null),x=d.pathname;(0,l.useEffect)((()=>{function e(e){u.current&&!u.current.contains(e.target)&&m(!1)}return c&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[c]);return(0,i.jsx)("div",{children:t&&(0,i.jsxs)("div",{ref:u,children:[(0,i.jsx)("button",{onClick:()=>{m(!c)},className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-md","aria-label":"Menu",title:"Menu",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),c&&(0,i.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-20",children:[(0,i.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700",children:["Hi, ",(null===a||void 0===a?void 0:a.username)||"Guest"]}),(0,i.jsx)("hr",{className:"my-1"}),"/home"!==x&&(0,i.jsx)("button",{onClick:()=>{o("/home"),m(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Home"}),"/profile"!==x&&(0,i.jsx)("button",{onClick:()=>{o("/profile"),m(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Profile"}),"/ingredient-recommendations"!==x&&(0,i.jsx)("button",{onClick:()=>{o("/ingredient-recommendations"),m(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Search by Ingredient"}),(0,i.jsx)("hr",{className:"my-1"}),(0,i.jsx)("button",{onClick:()=>{n(),o("/"),m(!1)},className:"block w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-gray-100",children:"Logout"})]})]})})}}}]);
//# sourceMappingURL=197.78321407.chunk.js.map